<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Game Final</title>
<style>
    body { font-family: sans-serif; }

    /* Top bar for other players (P2â€“P4 only) */
    #othersBar {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
    }

    .playerBox {
        padding: 10px;
        border: 2px solid #333;
        width: 150px;
        border-radius: 5px;
        background: #eee;
    }

    /* Current player displayed separately */
    #currentPlayerBox {
        border: 3px solid green;
        padding: 15px;
        width: 250px;
        background: #f6fff0;
        border-radius: 10px;
        margin-bottom: 20px;
    }
</style>
</head>
<body>

<h2>Game Status</h2>

<!-- Player One (current player) goes here -->
<div id="currentPlayerBox">
    <h3 id="cp_name">Current Player</h3>
    <p>Health: <span id="cp_health">0</span></p>
    <p>Cards: <span id="cp_cards">0</span></p>
</div>

<!-- Only P2, P3, P4 boxes go up here -->
<div id="othersBar">
    <div class="playerBox">
        <h4 id="p2_name">Player 2</h4>
        <p>Health: <span id="p2_health">0</span></p>
        <p>Cards: <span id="p2_cards">0</span></p>
    </div>

    <div class="playerBox">
        <h4 id="p3_name">Player 3</h4>
        <p>Health: <span id="p3_health">0</span></p>
        <p>Cards: <span id="p3_cards">0</span></p>
    </div>

    <div class="playerBox">
        <h4 id="p4_name">Player 4</h4>
        <p>Health: <span id="p4_health">0</span></p>
        <p>Cards: <span id="p4_cards">0</span></p>
    </div>
</div>

<button id="refreshBtn">Refresh</button>

<script>
// Load game state at page load
window.onload = () => {
    refreshGame();
};

// Refresh button
document.getElementById("refreshBtn").onclick = () => {
    refreshGame();
};

async function refreshGame() {
    try {
        const res = await fetch("/game/state");
        const data = await res.json();

        // ----- Current Player -----
        document.getElementById("cp_name").innerText   = data.current.name;
        document.getElementById("cp_health").innerText = data.current.health;
        document.getElementById("cp_cards").innerText  = data.current.cards;

        // ----- Others (P2, P3, P4) -----
        updateOther("p2", data.players[1]);
        updateOther("p3", data.players[2]);
        updateOther("p4", data.players[3]);

    } catch (err) {
        console.error("Refresh error:", err);
    }
}

function updateOther(prefix, p) {
    if (!p) return; // safety check
    document.getElementById(prefix + "_name").innerText   = p.name;
    document.getElementById(prefix + "_health").innerText = p.health;
    document.getElementById(prefix + "_cards").innerText  = p.cards;
}
</script>
</body>