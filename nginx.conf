server {
    listen 80;

    # This location block handles all requests to the root (/)
    location / {
        # Check if the requested file exists (e.g., index.html, frontback.jpg).
        # If it exists, NGINX serves it directly (Static File).
        # If it DOES NOT exist (e.g., a POST request or an API call), 
        # NGINX forwards the request to your C++ application on port 8080.
        try_files $uri $uri/ @backend; 
    }
    
    # This is a named location block that acts as the Reverse Proxy 
    # to your C++ backend. All POST/dynamic requests will end up here.
    location @backend {
        proxy_pass http://127.0.0.1:8080;
        
        # Standard headers needed for proxying
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    # Remove the old /api/ location since the @backend handles everything
    # (Unless you specifically need a separate /api/ endpoint, we'll simplify)
}
